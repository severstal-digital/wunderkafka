# Wunderkafka

## v.0.18.0 (2024-11-29)

### Added

- added pre-configured consumers and producer for JSON-value string-key messages without any schema registry support.

## v.0.17.1 (2024-10-16)

### Fixed

- trusted publishers environment settings.

## v.0.17.0 (2024-10-16)

### Fixed

- no more ValidationError in tombstone messages should be raised
- no more auxiliary doc generated by default in derived schemas

### Changed

- dropped support of Python 3.8
- updated minimal required confluent-kafka version to >=1.9.0, to fully remove own kerberos refresh logic in future. 
- switched to trusted publishers
- updated GitHub actions
- updated readthedocs build image

## v0.16.1 (2024-01-23) 

### Added

- pre-configured consumers and producers for avro-value/string-key and JSON-value/string-key

### Fixed

- avro: disallow deriving schemas with names which are not valid [avro names](https://avro.apache.org/docs/1.11.1/specification/#names)

## v0.16.0 (2024-01-19) 

### Added

- Support for `confluent`-like JSON Schema (de)serialization. This functionality requires `jsonschema` package to be installed.
- Now consumer may return `StreamResult`. It is useful to handle deserialization errors in user's code without raising exceptions in the middle of already consumed batch.

### Changed

- `HighLevelSerializingProducer` now accepts separate value and key serializers. This allows usage of mixed serialization protocols for the key and value per producer.
- `Serializer`s now may be configured via specific `Store` instance to handle its own type of schemas correctly (`Store` may be shared or not be shared for some reason).

### Fixed

- Nested models are now derived more correctly (e.g., deep nested `Annotated` fields)
- Subject naming strategy for `confluent` is now 'topic-{key|value}' instead of 'topic_{key|value}'

## v0.15.0 (2024-01-12) 

### Added

- This changelog file with some info about old versions

### Changed

- Updated minimal required version of `dataclasses-avroschema` to `0.53.0`. Prior versions doesn't pass library's test suites against `pydantic V2` and require effort to implement

### Fixed

- Nested `BaseModel`-inherited structures are not supported for schema derivation
- `sphinx` docs were broken for some time (since `v0.12.0`, update to `pydantic V2`)
- Config generator of `librdkafka` options now generates code which is more compliant with PEP-8
- Annotations for describing avro Schemas are updated as in `fastavro`

## v0.14.2 (2023-11-17)

### Fixed

- Check if `cmd_init` is set for the HTTP client

## v0.14.1 (2023-10-24)

### Added 

- HTTP client may be initialized with `cmd_kinit` argument. When provided, the client starts its own thread to handle kerberos ticket (awaits `kinit` to be present in runtime environment) 

## v0.14.0 (2023-10-10)

### Fixed

- Set default timeout for subprocess calls of `klist` and `kinit`.

## v0.13.1 (2023-09-29)

### Fixed

- Unexpected suffixes from `confluent_kafka.libversion()` are now removed

## v0.13.0 (2023-09-28)

### Added

- Possibility to use multiple keytabs like librdkafka does

### Fixed

- Multiple bugs related to kerberos-related functionality 

## v0.12.0 (2023-08-29)

### Added

- Configurations of librdkafka up to 2.2.0

### Changed

- From now support only `pydantic V2`
- Kerberos-related functionality is now optional for a package

### Fixed

- Now some builtin-features are checked in runtime and don't raise errors due to absent system dependencies
- `urlparse` paths in tests for schema registry stub in a file system
